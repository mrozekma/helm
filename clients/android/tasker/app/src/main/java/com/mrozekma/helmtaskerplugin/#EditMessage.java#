package com.mrozekma.helmtaskerplugin;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.widget.EditText;


public class EditMessage extends Activity {
    private static int DESCRIPTION_LENGTH = 60;
    priv
    private EditText host, exchange, username, password, message;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        this.host = (EditText)this.findViewById(R.id.host);
        this.exchange = (EditText)this.findViewById(R.id.exchange);
        this.username = (EditText)this.findViewById(R.id.username);
        this.password = (EditText)this.findViewById(R.id.password);
        this.message = (EditText)this.findViewById(R.id.message);

        final Intent intent = this.getIntent();
        intent.getStr
        if(intent != null) {
            this.host.setText(intent.getStringExtra(SendMessage.BUNDLE_EXTRA_HOST, ""));
            this.exchange.setText(intent.getStringExtra(SendMessage.BUNDLE_EXTRA_EXCHANGE, ""));
            this.username.setText(intent.getStringExtra(SendMessage.BUNDLE_EXTRA_USERNAME, ""));
            this.password.setText(intent.getStringExtra(SendMessage.BUNDLE_EXTRA_PASSWORD, ""));
            this.message.setText(intent.getStringExtra(SendMessage.BUNDLE_EXTRA_MESSAGE, ""));
        }
    }

    @Override
    public void finish() {
        final String message = this.message.getText().toString();

        final Bundle bundle = new Bundle();
        bundle.putString(SendMessage.BUNDLE_EXTRA_HOST, this.host.getText().toString());
        bundle.putString(SendMessage.BUNDLE_EXTRA_EXCHANGE, this.exchange.getText().toString());
        bundle.putString(SendMessage.BUNDLE_EXTRA_USERNAME, this.username.getText().toString());
        bundle.putString(SendMessage.BUNDLE_EXTRA_PASSWORD, this.password.getText().toString());
        bundle.putString(SendMessage.BUNDLE_EXTRA_MESSAGE, message);

        final Intent intent = new Intent();
        intent.putExtra(com.twofortyfouram.locale.Intent.EXTRA_BUNDLE, bundle);
        intent.putExtra(com.twofortyfouram.locale.Intent.EXTRA_STRING_BLURB, message.length() <= DESCRIPTION_LENGTH ? message : message.substring(0, DESCRIPTION_LENGTH));

        this.setResult(RESULT_OK, intent);
        super.finish();
    }
}
